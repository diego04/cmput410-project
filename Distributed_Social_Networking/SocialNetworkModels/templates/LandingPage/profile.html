{% extends "index.html" %}
{% load staticfiles %}
{%block head%}
        {% if user.is_authenticated %}
		{% include 'navigationbar.html' %}
        {% endif %}
{%endblock%}

{%block body%}

{% if edit == '0' or edit == '2' %}
<div class="panel panel-default">
	<div class="panel-heading">
		{% if edit == '0' %}
			<p><a href="/profile1/" class="pull-right">Edit</a></p>
		{% else %}
		{% endif %}
		<h2>Profile</h2>
	</div>
	<div class="panel-body">
		<p><img src="{{STATIC_URL}}../{{picture}}"/></p>
		<label for="id_username">Username:</label>
		<p>{{username}}</p>
		<label for="id_email">Email address:</label> 
		<p>{{email}}</p>
		<label for="github">github username:</label>	 
		<p>{{github_username}}</p>
	</div>
	<div class="panel-body">
		{%for p in posts %}
			{% if p.post_author.user.username = username %}
			<a href="/display/{{p.post_id}}/">{{p.post_title}} </a> 
			by <a href="/profile_post/{{p.post_author}}/">{{p.post_author}}</a>                                
			{% if p.image %}
			<img src="{{STATIC_URL}}../{{p.image}}" style="width:100px;height:100px;"  /> 
			{%else%}  
			{% endif %}  
			{{p.post_text}}
			{% endif %}     
		{% endfor %}
		{%for p in post %}
			<a href="/display/{{p.guid}}/">{{p.title}} </a> 
			by 
			<a href="/profile_post/{{p.author.id}}/">{{p.author.displayname}}</a>
			{% if p.image %}
				<img src="{{STATIC_URL}}../{{post.image}}" style="width:100px;height:100px;"/> 
			{%else%}  
			{% endif %}  
			{{p.content}}
			{%for comment in p.comments %}
				<a href="/profile_post/{{comment.author.id}}/">
				{{comment.author.displayname}}
				</a>{{comment.comment}}
			{% endfor %}		
		{%endfor%}	
	</div>
</div>
{% endif %}

{% if edit == '1' %}
<form id="user_form" method="post" action="/profile_edit/"
        enctype="multipart/form-data">
        {% csrf_token %}
	 <div class="panel panel-default">
	 <div class="panel-body">
	 <div class="panel-more1">
	<label for="id_username">Username:</label> </br>
    <input id="id_username" maxlength="30" name="username" type="text" value = "{{username}}" /> </div></div></div>
	 <div class="panel panel-default">
	 <div class="panel-body">
	 <div class="panel-more1">
    <label for="id_email">Email address:</label> </br>
    <input id="id_email" maxlength="75" name="email" type="email" value = "{{email}}" /> </div></div></div>
	 <div class="panel panel-default">
	 <div class="panel-body">
	 <div class="panel-more1">
    <label for="github">github username:</label> </br>
    <input id="id_website" maxlength="200" name="github_username" type="text" value = "{{github_username}}" /> </div></div></div>
	 <div class="panel panel-default">
	 <div class="panel-body">
	 <div class="panel-more1">
    <label for="id_picture">Picture:</label> </br>
    <input id="id_picture" name="picture" type="file" onchange="readURL(this);" class="btn btn-default"/> </br>
    <img id="blah" src="{{STATIC_URL}}../{{picture}}" alt="your image" />  </div></div></div>
    <!-- Provide a button to click to submit the form. -->
    <input type="submit" name="submit" value="Submit" onclick = "return checkEmpty();" class="btn btn-default"/>
</form>
{% endif %}


<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script type="text/javascript">google.load("feeds", "1");</script>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>

<div class="panel panel-default">
	<div class="panel-body">
		<button onclick="myFunction()">Try it</button>
		<p>Click the button to display an alert box:</p>
	</div>
</div>

<script>
function myFunction() {
var feed = new google.feeds.Feed('https://github.com/diego04.atom');
feed.load(function (data) {
	//alert(JSON.stringify(data));
    // Parse data depending on the specified response format, default is JSON.
    if (data['status']['code'] < 300 || data['status']['code'] >= 200){
                    $( "p" ).append( ("</br>"));

    $( "p" ).append( document.createTextNode(JSON.stringify(data['feed']['title'])));
                    $( "p" ).append( ("</br>"));

    $( "p" ).append( document.createTextNode(JSON.stringify(data['feed']['link'])));
                    $( "p" ).append( ("</br>"));

    //entries = jQuery.parseJSON(data['feed']['entries'])
        entries = jQuery.parseJSON(JSON.stringify(data['feed']['entries']));

        //$( "p" ).append( document.createTextNode(JSON.stringify(entries)));

    $.each((entries), function(key,value){
    $( "p" ).append( document.createTextNode(JSON.stringify(value['title'])));
                $( "p" ).append( ("</br>"));

        $( "p" ).append( document.createTextNode(JSON.stringify(value['link'])));
                $( "p" ).append( ("</br>"));

        $( "p" ).append( document.createTextNode(JSON.stringify(value['author'])));
                $( "p" ).append( ("</br>"));

        $( "p" ).append( document.createTextNode(JSON.stringify(value['publishedDate'])));
                $( "p" ).append( ("</br>"));

        $( "p" ).append((JSON.stringify(value['content'].replace(new RegExp('\r?\n','g'), '<br />'))));
                $( "p" ).append( ("</br>"));


    //$( "p" ).append( ('ei'));

    });
    /*for (x=0; x < entries.length; x++){

    $( "p" ).append( document.createTextNode(entries[x]));
        $( "p" ).append( document.createTextNode(entries[x]));

    //$( "p" ).append( document.createTextNode((x)));

    	}//for */
    }//if conditional on 'ok' status code

});

}
</script>


{%endblock%}
